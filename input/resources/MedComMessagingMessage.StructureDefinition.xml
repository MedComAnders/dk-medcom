<?xml version="1.0" encoding="utf-8"?>
<StructureDefinition xmlns="http://hl7.org/fhir">
  <id value="medcom-messaging-message" />
  <meta>
    <lastUpdated value="2020-01-20T12:40:52.43+00:00" />
  </meta>
  <url value="http://medcom.dk/fhir/medcom-core/StructureDefinition/medcom-messaging-message" />
  <name value="MedComMessagingMessage" />
  <status value="draft" />
  <date value="2020-01-20T12:40:52.2493694+00:00" />
  <fhirVersion value="4.0.1" />
  <mapping>
    <identity value="v2" />
    <uri value="http://hl7.org/v2" />
    <name value="HL7 v2 Mapping" />
  </mapping>
  <mapping>
    <identity value="rim" />
    <uri value="http://hl7.org/v3" />
    <name value="RIM Mapping" />
  </mapping>
  <mapping>
    <identity value="cda" />
    <uri value="http://hl7.org/v3/cda" />
    <name value="CDA (R2)" />
  </mapping>
  <mapping>
    <identity value="w5" />
    <uri value="http://hl7.org/fhir/fivews" />
    <name value="FiveWs Pattern Mapping" />
  </mapping>
  <kind value="resource" />
  <abstract value="false" />
  <type value="Bundle" />
  <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Bundle" />
  <derivation value="constraint" />
  <differential>
    <element id="Bundle">
      <path value="Bundle" />
      <short value="MedCom Message" />
      <definition value="A container for a MedCom message." />
    </element>
    <element id="Bundle.type">
      <path value="Bundle.type" />
      <short value="Type of bundle, must be message" />
      <definition value="Type of bundle, must be message to indicata that this is a message and conforms to the messaging rules" />
      <fixedCode value="message" />
      <mustSupport value="true" />
    </element>
    <element id="Bundle.timestamp">
      <path value="Bundle.timestamp" />
      <short value="When the message was assembled" />
      <definition value="The date/time that the message was assembled" />
      <comment value="The date that the content of the message was assembled. This date is not changed by middleware engines unless they add additional data that changes the meaning of the time of the message." />
      <min value="1" />
      <mustSupport value="true" />
    </element>
    <element id="Bundle.entry">
      <path value="Bundle.entry" />
      <slicing>
        <discriminator>
          <type value="profile" />
          <path value="resource" />
        </discriminator>
        <rules value="open" />
      </slicing>
    </element>
    <element id="Bundle.entry:messageHeader">
      <path value="Bundle.entry" />
      <sliceName value="messageHeader" />
      <short value="Message header" />
      <definition value="Message header - must contain a MedComMessagingMessageHeader resource." />
      <min value="1" />
      <max value="1" />
      <orderMeaning value="For bundles of type 'message', the first resource is special (must be MessageHeader)." />
      <mustSupport value="true" />
    </element>
    <element id="Bundle.entry:messageHeader.resource">
      <path value="Bundle.entry.resource" />
      <short value="Message header resource" />
      <min value="1" />
      <type>
        <code value="Resource" />
        <profile value="http://medcom.dk/fhir/medcom-core/StructureDefinition/medcom-messaging-messageHeader" />
      </type>
      <mustSupport value="true" />
    </element>
    <element id="Bundle.entry:messageHistory">
      <path value="Bundle.entry" />
      <sliceName value="messageHistory" />
      <mustSupport value="true" />
      <definition value="Shall contain a provenance resource for all messages preceeding this message. A new provenance resource is added when a message is replied to, forwarded or in any other way handed over to a new organization." />
    </element>
    <element id="Bundle.entry:messageHistory.resource">
      <path value="Bundle.entry.resource" />
      <min value="1" />
      <type>
        <code value="Resource" />
        <profile value="http://medcom.dk/fhir/medcom-core/StructureDefinition/medcom-message-provenance" />
      </type>
      <mustSupport value="true" />
    </element>
  </differential>
</StructureDefinition>